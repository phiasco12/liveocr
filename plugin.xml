<?xml version="1.0" encoding="utf-8"?>
<plugin id="cordova-plugin-live-ocr" version="1.0.0" xmlns="http://apache.org/cordova/ns/plugins/1.0">

  <name>LiveOCR</name>

  <js-module name="LiveOCR" src="www/LiveOCR.js">
    <clobbers target="LiveOCR" />
  </js-module>

  <platform name="android">

    <config-file target="AndroidManifest.xml" parent="/manifest/application">
      <activity
        android:name="com.serial.liveocr.OCRActivity"
        android:exported="false"
        android:theme="@style/Theme.AppCompat.Light.NoActionBar"
        android:screenOrientation="portrait"/>
    </config-file>

    <config-file target="res/xml/config.xml" parent="/*">
      <feature name="LiveOCR">
        <param name="android-package" value="com.serial.liveocr.LiveOCR" />
      </feature>
    </config-file>

    <config-file target="AndroidManifest.xml" parent="/manifest">
      <uses-permission android:name="android.permission.CAMERA" />
    </config-file>

    <!-- Camera + Lifecycle -->
    <framework src="androidx.appcompat:appcompat:1.7.0" />
    <framework src="androidx.activity:activity:1.9.2" />
    <framework src="androidx.lifecycle:lifecycle-runtime:2.8.6" />
    <framework src="androidx.camera:camera-core:1.3.4" />
    <framework src="androidx.camera:camera-camera2:1.3.4" />
    <framework src="androidx.camera:camera-lifecycle:1.3.4" />
    <framework src="androidx.camera:camera-view:1.3.4" />

    <!-- ✅ FIXED: No pipeline, supports 16KB devices -->
    <framework src="com.google.mlkit:text-recognition:16.0.0" />

    <!-- ✅ FIXED: Correct Java install path -->
    <source-file src="src/android/LiveOCR.java" target-dir="src/com/serial/liveocr" />
    <source-file src="src/android/OCRActivity.java" target-dir="src/com/serial/liveocr" />

  </platform>
</plugin>
